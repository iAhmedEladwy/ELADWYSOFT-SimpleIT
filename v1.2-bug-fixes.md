
# v1.2 Bug Fixes & Improvements Plan

## Executive Summary
This document outlines all identified issues in the SimpleIT application and provides a structured plan to resolve them systematically.

---

## Dashboard Issues

### 1. Active Tickets Count Bug ‚úÖ FIXED
**Issue**: Dashboard shows only "Open" tickets, should include "In Progress" tickets as well.
**Root Cause**: `/api/dashboard/summary` endpoint only queries tickets with "Open" status.
**Solution**: Updated query to include both "Open" and "In Progress" ticket statuses.
**Files Modified**: `server/routes.ts` - dashboard summary endpoint
**Status**: COMPLETED

### 2. Assets by Type Display Issue
**Issue**: Assets by type chart doesn't show data correctly on dashboard.
**Root Cause**: Data mapping or chart rendering issue in AssetsByType component.
**Investigation Needed**: 
- Check data format returned by `/api/dashboard/summary`
- Verify chart component props and data transformation
- Test with sample data
**Files to Check**: `client/src/components/dashboard/AssetsByType.tsx`
**Priority**: Medium

---

## Tickets Module Issues

### 3. Ticket Update Issues
**Issue**: General ticket update problems reported.
**Root Cause**: Need investigation - could be validation, API endpoints, or form submission.
**Investigation Steps**:
- Test ticket update functionality
- Check validation rules
- Verify API endpoint responses
- Check form data submission
**Files to Check**: 
- `client/src/components/tickets/TicketForm.tsx`
- `client/src/components/tickets/TicketUpdateForm.tsx`
- `server/routes.ts` - ticket update endpoints
**Priority**: High

### 4. Ticket History Display Issue
**Issue**: Ticket History doesn't show historical data correctly.
**Root Cause**: Database schema or query issue in ticket history system.
**Investigation**: 
- Verify `ticket_history` table structure
- Check `getTicketHistory` method in storage layer
- Test history creation on ticket updates
**Files to Check**: 
- `server/storage.ts` - getTicketHistory method
- Database schema for ticket_history table
**Priority**: High

### 5. Tickets Assigned To Shows Employees Instead of Users
**Issue**: Assignment dropdown shows employees instead of users.
**Root Cause**: Wrong data source in ticket assignment component.
**Solution**: Update assignment dropdown to fetch from `/api/users` instead of `/api/employees`.
**Files to Modify**:
- `client/src/components/tickets/TicketForm.tsx`
- `client/src/components/tickets/TicketUpdateForm.tsx`
**Priority**: Medium

### 6. Start Tracking Function Not Working
**Issue**: Time tracking start function doesn't reflect real status.
**Root Cause**: API endpoint or state management issue.
**Investigation**:
- Test `/api/tickets/:id/start-tracking` endpoint
- Check time tracking state management
- Verify database updates for tracking status
**Files to Check**:
- `server/routes.ts` - time tracking endpoints
- `client/src/components/tickets/` - time tracking components
**Priority**: Medium

### 7. Request Type Uses Hard-coded Data ‚úÖ PARTIALLY FIXED
**Issue**: Request types are hard-coded instead of using custom request types from system config.
**Status**: Custom request types system is implemented, need to verify all forms use it.
**Verification Needed**:
- Check all ticket forms use `/api/custom-request-types`
- Remove any hard-coded request type arrays
**Files to Check**: All ticket form components
**Priority**: Low

### 8. Remove Tabbed Filtration and Add User Filter
**Issue**: Current ticket filtration system needs redesign.
**Requirements**:
- Remove existing tabbed filter system
- Add filter by User dropdown
- Display "(Current)" beside logged-in user
**Files to Modify**:
- `client/src/pages/Tickets.tsx`
- `client/src/components/tickets/TicketsTable.tsx`
**Priority**: Medium

---

## Employee Management Issues

### 9. Employee CRUD Operations - Error 400 and 404 üîç IDENTIFIED
**Issue**: Add new, update, and delete operations return 400 and 404 errors.
**Root Cause Found**: 
- **Create**: SQL syntax error in employee creation query (comma-related)
- **Delete**: Foreign key constraint violation (employees referenced by tickets)
**Solutions**:
- Fix SQL syntax in `createEmployee` method
- Implement cascading delete or reference handling for employee deletion
**Files to Fix**:
- `server/storage.ts` - createEmployee and deleteEmployee methods
- Consider database foreign key constraint modifications
**Priority**: High

### 10. Employee Filtration Issues
**Issue**: Filtrations have no title and Department/Types have duplicate values.
**Root Cause**: Frontend filter component implementation issues.
**Solutions**:
- Add proper titles to filter sections
- Implement deduplication for dropdown options
- Fix filter state management
**Files to Modify**:
- `client/src/components/employees/EmployeesTable.tsx`
- `client/src/pages/Employees.tsx`
**Priority**: Medium

---

## Asset Management Issues

### 11. Factory OS Field Issues
**Issue**: Shows error if editing asset and left empty, needs name change to "Installed OS".
**Solutions**:
- Add proper validation for OS field (allow empty)
- Update label from "Factory OS" to "Installed OS"
- Update database column name if needed
**Files to Modify**:
- `client/src/components/assets/AssetForm.tsx`
- `server/storage.ts` - asset schema validation
**Priority**: Low

### 12. Asset Maintenance Tab Shows No Records
**Issue**: Maintenance tab doesn't display maintenance records.
**Root Cause**: API endpoint or component rendering issue.
**Investigation**:
- Test `/api/assets/:id/maintenance` endpoint
- Check maintenance data fetching in component
- Verify maintenance table structure
**Files to Check**:
- `client/src/components/assets/AssetDetailView.tsx`
- `server/routes.ts` - maintenance endpoints
**Priority**: Medium

### 13. Add Asset Column Selection Feature
**Issue**: Missing option to select which columns to display in assets table.
**Requirements**:
- Add column visibility controls
- Save user preferences
- Implement responsive column hiding
**Files to Modify**:
- `client/src/components/assets/AssetsTable.tsx`
- Add column management component
**Priority**: Low

### 14. Add Asset Filtrations (Type, Brand, Model Name)
**Issue**: Missing filter options for assets.
**Requirements**:
- Add filter dropdowns for Type, Brand, Model Name
- Implement search functionality
- Add filter reset option
**Files to Modify**:
- `client/src/components/assets/AssetsTable.tsx`
- `client/src/pages/Assets.tsx`
**Priority**: Medium

---

## Asset History Module Issues

### 15. Asset History Data Display Issue
**Issue**: Asset History module doesn't show data correctly.
**Root Cause**: API endpoint or data transformation issue.
**Investigation**:
- Test asset history API endpoints
- Check data fetching and rendering
- Verify transaction history display
**Files to Check**:
- `client/src/pages/AssetHistory.tsx`
- `client/src/components/assets/TransactionHistoryTable.tsx`
**Priority**: Medium

### 16. Add Pagination to Asset History
**Issue**: Need option to limit results per page.
**Requirements**:
- Implement pagination controls
- Add page size selector
- Update API to support pagination
**Files to Modify**:
- `client/src/pages/AssetHistory.tsx`
- `server/routes.ts` - asset history endpoints
**Priority**: Low

### 17. Side Navigation Hide Issue
**Issue**: Can't hide side navigation while on Asset History page.
**Root Cause**: Layout component state management issue.
**Solution**: Fix sidebar toggle functionality for this specific page.
**Files to Check**:
- `client/src/components/layout/Layout.tsx`
- `client/src/pages/AssetHistory.tsx`
**Priority**: Low

---

## System Configuration Issues

### 18. Department Tab State Management ‚úÖ PARTIALLY IMPLEMENTED
**Issue**: After CRUD operations, doesn't stay on same tab.
**Status**: Tab state management exists, need to verify it works for all CRUD operations.
**Verification Needed**:
- Test add/edit/delete operations
- Ensure `activeTab` state persists
**Files to Check**:
- `client/src/pages/SystemConfig.tsx`
**Priority**: Low

### 19. Import/Export Functions Not Working
**Issue**: Incorrect mapping causing import/export failures.
**Root Cause**: Data field mapping inconsistencies between export and import.
**Investigation**:
- Test import/export for all modules
- Verify field mappings
- Check CSV format consistency
**Files to Check**:
- `server/routes.ts` - import/export endpoints
- `shared/csvUtils.ts`
- `shared/importExportRules.ts`
**Priority**: Medium

### 20. Remove Demo Data Error 500 üîç NEEDS INVESTIGATION
**Issue**: Remove demo data function returns server error.
**Root Cause**: Likely foreign key constraint violations during deletion.
**Investigation**:
- Check deletion order in `removeDemoData` method
- Implement proper cascading deletes
- Add transaction handling
**Files to Check**:
- `server/storage.ts` - removeDemoData method
- Database foreign key constraints
**Priority**: Medium

---

## Implementation Priority Matrix

### High Priority (Fix First)
1. ‚úÖ Dashboard Active Tickets Count (COMPLETED)
2. Employee CRUD Operations (400/404 errors)
3. Ticket Update Issues
4. Ticket History Display Issue

### Medium Priority (Fix Second)
5. Assets by Type Display Issue
6. Tickets Assigned To Shows Employees
7. Start Tracking Function
8. Remove Tabbed Filtration and Add User Filter
9. Employee Filtration Issues
10. Asset Maintenance Tab Shows No Records
11. Add Asset Filtrations
12. Asset History Data Display Issue
13. Import/Export Functions Not Working
14. Remove Demo Data Error 500

### Low Priority (Fix Last)
15. Request Type Hard-coded Data (verify fix)
16. Factory OS Field Issues
17. Add Asset Column Selection Feature
18. Add Asset History Pagination
19. Side Navigation Hide Issue
20. Department Tab State Management (verify fix)

---

## Implementation Timeline

### Phase 1: Critical Fixes (Week 1)
- Fix employee CRUD operations
- Resolve ticket update issues
- Fix ticket history display

### Phase 2: Core Functionality (Week 2)
- Fix assets by type display
- Resolve ticket assignment issues
- Fix time tracking functionality
- Update ticket filtration system

### Phase 3: Data Management (Week 3)
- Fix import/export functions
- Resolve asset maintenance display
- Fix asset history issues
- Fix demo data removal

### Phase 4: UI/UX Improvements (Week 4)
- Add asset column selection
- Implement asset filtrations
- Add pagination features
- Fix navigation issues

---

## Testing Strategy

### Automated Testing
- API endpoint testing for all CRUD operations
- Database constraint testing
- Import/export data validation

### Manual Testing
- User workflow testing for each module
- Cross-browser compatibility testing
- Mobile responsiveness testing

### Regression Testing
- Test all fixed issues after each implementation
- Verify no new issues introduced
- Performance impact assessment

---

## Risk Assessment

### High Risk
- Database schema changes (foreign key constraints)
- Employee deletion with ticket references
- Import/export data integrity

### Medium Risk
- UI component state management changes
- API endpoint modifications
- Time tracking functionality changes

### Low Risk
- Label changes and UI improvements
- Adding new filter options
- Pagination implementations

---

## Success Criteria

### Functional Requirements
- All CRUD operations work without errors
- Data displays correctly across all modules
- Import/export functions work reliably
- Time tracking accurately reflects status

### Performance Requirements
- Page load times under 3 seconds
- API response times under 1 second
- No memory leaks in long-running sessions

### User Experience Requirements
- Intuitive navigation and filtering
- Clear error messages and feedback
- Consistent UI behavior across modules
- Mobile-friendly interface

---

## Rollback Plan

### Database Changes
- Maintain database backups before schema changes
- Document all migration scripts
- Test rollback procedures

### Code Changes
- Use feature branches for all fixes
- Maintain comprehensive commit history
- Test in staging environment first

### Monitoring
- Implement error tracking for new deployments
- Monitor system performance post-deployment
- User feedback collection system

---

*This plan will be updated as issues are resolved and new issues are discovered.*
